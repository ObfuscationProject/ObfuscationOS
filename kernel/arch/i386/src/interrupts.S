.intel_syntax noprefix
.section .text, "ax"
.code32

.extern isr_dispatch

.macro ISR_NOERR num
.global isr_stub_\num
.type isr_stub_\num, @function
isr_stub_\num:
    push 0
    push \num
    push eax
    push ecx
    push edx
    push ebx
    push ebp
    push esi
    push edi
    mov eax, esp
    push eax
    call isr_dispatch
    add esp, 4
    pop edi
    pop esi
    pop ebp
    pop ebx
    pop edx
    pop ecx
    pop eax
    add esp, 8
    iret
.endm

.macro ISR_ERR num
.global isr_stub_\num
.type isr_stub_\num, @function
isr_stub_\num:
    push \num
    push eax
    push ecx
    push edx
    push ebx
    push ebp
    push esi
    push edi
    mov eax, esp
    push eax
    call isr_dispatch
    add esp, 4
    pop edi
    pop esi
    pop ebp
    pop ebx
    pop edx
    pop ecx
    pop eax
    add esp, 8
    iret
.endm

ISR_NOERR 0
ISR_NOERR 1
ISR_NOERR 2
ISR_NOERR 3
ISR_NOERR 4
ISR_NOERR 5
ISR_NOERR 6
ISR_NOERR 7
ISR_ERR 8
ISR_NOERR 9
ISR_ERR 10
ISR_ERR 11
ISR_ERR 12
ISR_ERR 13
ISR_ERR 14
ISR_NOERR 15
ISR_NOERR 16
ISR_ERR 17
ISR_NOERR 18
ISR_NOERR 19
ISR_NOERR 20
ISR_NOERR 21
ISR_NOERR 22
ISR_NOERR 23
ISR_NOERR 24
ISR_NOERR 25
ISR_NOERR 26
ISR_NOERR 27
ISR_NOERR 28
ISR_NOERR 29
ISR_NOERR 30
ISR_NOERR 31
ISR_NOERR 32
ISR_NOERR 33
ISR_NOERR 34
ISR_NOERR 35
ISR_NOERR 36
ISR_NOERR 37
ISR_NOERR 38
ISR_NOERR 39
ISR_NOERR 40
ISR_NOERR 41
ISR_NOERR 42
ISR_NOERR 43
ISR_NOERR 44
ISR_NOERR 45
ISR_NOERR 46
ISR_NOERR 47
ISR_NOERR 48
ISR_NOERR 49
ISR_NOERR 50
ISR_NOERR 51
ISR_NOERR 52
ISR_NOERR 53
ISR_NOERR 54
ISR_NOERR 55
ISR_NOERR 56
ISR_NOERR 57
ISR_NOERR 58
ISR_NOERR 59
ISR_NOERR 60
ISR_NOERR 61
ISR_NOERR 62
ISR_NOERR 63
ISR_NOERR 64
ISR_NOERR 65
ISR_NOERR 66
ISR_NOERR 67
ISR_NOERR 68
ISR_NOERR 69
ISR_NOERR 70
ISR_NOERR 71
ISR_NOERR 72
ISR_NOERR 73
ISR_NOERR 74
ISR_NOERR 75
ISR_NOERR 76
ISR_NOERR 77
ISR_NOERR 78
ISR_NOERR 79
ISR_NOERR 80
ISR_NOERR 81
ISR_NOERR 82
ISR_NOERR 83
ISR_NOERR 84
ISR_NOERR 85
ISR_NOERR 86
ISR_NOERR 87
ISR_NOERR 88
ISR_NOERR 89
ISR_NOERR 90
ISR_NOERR 91
ISR_NOERR 92
ISR_NOERR 93
ISR_NOERR 94
ISR_NOERR 95
ISR_NOERR 96
ISR_NOERR 97
ISR_NOERR 98
ISR_NOERR 99
ISR_NOERR 100
ISR_NOERR 101
ISR_NOERR 102
ISR_NOERR 103
ISR_NOERR 104
ISR_NOERR 105
ISR_NOERR 106
ISR_NOERR 107
ISR_NOERR 108
ISR_NOERR 109
ISR_NOERR 110
ISR_NOERR 111
ISR_NOERR 112
ISR_NOERR 113
ISR_NOERR 114
ISR_NOERR 115
ISR_NOERR 116
ISR_NOERR 117
ISR_NOERR 118
ISR_NOERR 119
ISR_NOERR 120
ISR_NOERR 121
ISR_NOERR 122
ISR_NOERR 123
ISR_NOERR 124
ISR_NOERR 125
ISR_NOERR 126
ISR_NOERR 127
ISR_NOERR 128
ISR_NOERR 129
ISR_NOERR 130
ISR_NOERR 131
ISR_NOERR 132
ISR_NOERR 133
ISR_NOERR 134
ISR_NOERR 135
ISR_NOERR 136
ISR_NOERR 137
ISR_NOERR 138
ISR_NOERR 139
ISR_NOERR 140
ISR_NOERR 141
ISR_NOERR 142
ISR_NOERR 143
ISR_NOERR 144
ISR_NOERR 145
ISR_NOERR 146
ISR_NOERR 147
ISR_NOERR 148
ISR_NOERR 149
ISR_NOERR 150
ISR_NOERR 151
ISR_NOERR 152
ISR_NOERR 153
ISR_NOERR 154
ISR_NOERR 155
ISR_NOERR 156
ISR_NOERR 157
ISR_NOERR 158
ISR_NOERR 159
ISR_NOERR 160
ISR_NOERR 161
ISR_NOERR 162
ISR_NOERR 163
ISR_NOERR 164
ISR_NOERR 165
ISR_NOERR 166
ISR_NOERR 167
ISR_NOERR 168
ISR_NOERR 169
ISR_NOERR 170
ISR_NOERR 171
ISR_NOERR 172
ISR_NOERR 173
ISR_NOERR 174
ISR_NOERR 175
ISR_NOERR 176
ISR_NOERR 177
ISR_NOERR 178
ISR_NOERR 179
ISR_NOERR 180
ISR_NOERR 181
ISR_NOERR 182
ISR_NOERR 183
ISR_NOERR 184
ISR_NOERR 185
ISR_NOERR 186
ISR_NOERR 187
ISR_NOERR 188
ISR_NOERR 189
ISR_NOERR 190
ISR_NOERR 191
ISR_NOERR 192
ISR_NOERR 193
ISR_NOERR 194
ISR_NOERR 195
ISR_NOERR 196
ISR_NOERR 197
ISR_NOERR 198
ISR_NOERR 199
ISR_NOERR 200
ISR_NOERR 201
ISR_NOERR 202
ISR_NOERR 203
ISR_NOERR 204
ISR_NOERR 205
ISR_NOERR 206
ISR_NOERR 207
ISR_NOERR 208
ISR_NOERR 209
ISR_NOERR 210
ISR_NOERR 211
ISR_NOERR 212
ISR_NOERR 213
ISR_NOERR 214
ISR_NOERR 215
ISR_NOERR 216
ISR_NOERR 217
ISR_NOERR 218
ISR_NOERR 219
ISR_NOERR 220
ISR_NOERR 221
ISR_NOERR 222
ISR_NOERR 223
ISR_NOERR 224
ISR_NOERR 225
ISR_NOERR 226
ISR_NOERR 227
ISR_NOERR 228
ISR_NOERR 229
ISR_NOERR 230
ISR_NOERR 231
ISR_NOERR 232
ISR_NOERR 233
ISR_NOERR 234
ISR_NOERR 235
ISR_NOERR 236
ISR_NOERR 237
ISR_NOERR 238
ISR_NOERR 239
ISR_NOERR 240
ISR_NOERR 241
ISR_NOERR 242
ISR_NOERR 243
ISR_NOERR 244
ISR_NOERR 245
ISR_NOERR 246
ISR_NOERR 247
ISR_NOERR 248
ISR_NOERR 249
ISR_NOERR 250
ISR_NOERR 251
ISR_NOERR 252
ISR_NOERR 253
ISR_NOERR 254
ISR_NOERR 255

.global isr_stub_table
.type isr_stub_table, @object
isr_stub_table:
    .long isr_stub_0
    .long isr_stub_1
    .long isr_stub_2
    .long isr_stub_3
    .long isr_stub_4
    .long isr_stub_5
    .long isr_stub_6
    .long isr_stub_7
    .long isr_stub_8
    .long isr_stub_9
    .long isr_stub_10
    .long isr_stub_11
    .long isr_stub_12
    .long isr_stub_13
    .long isr_stub_14
    .long isr_stub_15
    .long isr_stub_16
    .long isr_stub_17
    .long isr_stub_18
    .long isr_stub_19
    .long isr_stub_20
    .long isr_stub_21
    .long isr_stub_22
    .long isr_stub_23
    .long isr_stub_24
    .long isr_stub_25
    .long isr_stub_26
    .long isr_stub_27
    .long isr_stub_28
    .long isr_stub_29
    .long isr_stub_30
    .long isr_stub_31
    .long isr_stub_32
    .long isr_stub_33
    .long isr_stub_34
    .long isr_stub_35
    .long isr_stub_36
    .long isr_stub_37
    .long isr_stub_38
    .long isr_stub_39
    .long isr_stub_40
    .long isr_stub_41
    .long isr_stub_42
    .long isr_stub_43
    .long isr_stub_44
    .long isr_stub_45
    .long isr_stub_46
    .long isr_stub_47
    .long isr_stub_48
    .long isr_stub_49
    .long isr_stub_50
    .long isr_stub_51
    .long isr_stub_52
    .long isr_stub_53
    .long isr_stub_54
    .long isr_stub_55
    .long isr_stub_56
    .long isr_stub_57
    .long isr_stub_58
    .long isr_stub_59
    .long isr_stub_60
    .long isr_stub_61
    .long isr_stub_62
    .long isr_stub_63
    .long isr_stub_64
    .long isr_stub_65
    .long isr_stub_66
    .long isr_stub_67
    .long isr_stub_68
    .long isr_stub_69
    .long isr_stub_70
    .long isr_stub_71
    .long isr_stub_72
    .long isr_stub_73
    .long isr_stub_74
    .long isr_stub_75
    .long isr_stub_76
    .long isr_stub_77
    .long isr_stub_78
    .long isr_stub_79
    .long isr_stub_80
    .long isr_stub_81
    .long isr_stub_82
    .long isr_stub_83
    .long isr_stub_84
    .long isr_stub_85
    .long isr_stub_86
    .long isr_stub_87
    .long isr_stub_88
    .long isr_stub_89
    .long isr_stub_90
    .long isr_stub_91
    .long isr_stub_92
    .long isr_stub_93
    .long isr_stub_94
    .long isr_stub_95
    .long isr_stub_96
    .long isr_stub_97
    .long isr_stub_98
    .long isr_stub_99
    .long isr_stub_100
    .long isr_stub_101
    .long isr_stub_102
    .long isr_stub_103
    .long isr_stub_104
    .long isr_stub_105
    .long isr_stub_106
    .long isr_stub_107
    .long isr_stub_108
    .long isr_stub_109
    .long isr_stub_110
    .long isr_stub_111
    .long isr_stub_112
    .long isr_stub_113
    .long isr_stub_114
    .long isr_stub_115
    .long isr_stub_116
    .long isr_stub_117
    .long isr_stub_118
    .long isr_stub_119
    .long isr_stub_120
    .long isr_stub_121
    .long isr_stub_122
    .long isr_stub_123
    .long isr_stub_124
    .long isr_stub_125
    .long isr_stub_126
    .long isr_stub_127
    .long isr_stub_128
    .long isr_stub_129
    .long isr_stub_130
    .long isr_stub_131
    .long isr_stub_132
    .long isr_stub_133
    .long isr_stub_134
    .long isr_stub_135
    .long isr_stub_136
    .long isr_stub_137
    .long isr_stub_138
    .long isr_stub_139
    .long isr_stub_140
    .long isr_stub_141
    .long isr_stub_142
    .long isr_stub_143
    .long isr_stub_144
    .long isr_stub_145
    .long isr_stub_146
    .long isr_stub_147
    .long isr_stub_148
    .long isr_stub_149
    .long isr_stub_150
    .long isr_stub_151
    .long isr_stub_152
    .long isr_stub_153
    .long isr_stub_154
    .long isr_stub_155
    .long isr_stub_156
    .long isr_stub_157
    .long isr_stub_158
    .long isr_stub_159
    .long isr_stub_160
    .long isr_stub_161
    .long isr_stub_162
    .long isr_stub_163
    .long isr_stub_164
    .long isr_stub_165
    .long isr_stub_166
    .long isr_stub_167
    .long isr_stub_168
    .long isr_stub_169
    .long isr_stub_170
    .long isr_stub_171
    .long isr_stub_172
    .long isr_stub_173
    .long isr_stub_174
    .long isr_stub_175
    .long isr_stub_176
    .long isr_stub_177
    .long isr_stub_178
    .long isr_stub_179
    .long isr_stub_180
    .long isr_stub_181
    .long isr_stub_182
    .long isr_stub_183
    .long isr_stub_184
    .long isr_stub_185
    .long isr_stub_186
    .long isr_stub_187
    .long isr_stub_188
    .long isr_stub_189
    .long isr_stub_190
    .long isr_stub_191
    .long isr_stub_192
    .long isr_stub_193
    .long isr_stub_194
    .long isr_stub_195
    .long isr_stub_196
    .long isr_stub_197
    .long isr_stub_198
    .long isr_stub_199
    .long isr_stub_200
    .long isr_stub_201
    .long isr_stub_202
    .long isr_stub_203
    .long isr_stub_204
    .long isr_stub_205
    .long isr_stub_206
    .long isr_stub_207
    .long isr_stub_208
    .long isr_stub_209
    .long isr_stub_210
    .long isr_stub_211
    .long isr_stub_212
    .long isr_stub_213
    .long isr_stub_214
    .long isr_stub_215
    .long isr_stub_216
    .long isr_stub_217
    .long isr_stub_218
    .long isr_stub_219
    .long isr_stub_220
    .long isr_stub_221
    .long isr_stub_222
    .long isr_stub_223
    .long isr_stub_224
    .long isr_stub_225
    .long isr_stub_226
    .long isr_stub_227
    .long isr_stub_228
    .long isr_stub_229
    .long isr_stub_230
    .long isr_stub_231
    .long isr_stub_232
    .long isr_stub_233
    .long isr_stub_234
    .long isr_stub_235
    .long isr_stub_236
    .long isr_stub_237
    .long isr_stub_238
    .long isr_stub_239
    .long isr_stub_240
    .long isr_stub_241
    .long isr_stub_242
    .long isr_stub_243
    .long isr_stub_244
    .long isr_stub_245
    .long isr_stub_246
    .long isr_stub_247
    .long isr_stub_248
    .long isr_stub_249
    .long isr_stub_250
    .long isr_stub_251
    .long isr_stub_252
    .long isr_stub_253
    .long isr_stub_254
    .long isr_stub_255

.global irq_return_trampoline
.type irq_return_trampoline, @function
irq_return_trampoline:
    pop edi
    pop esi
    pop ebp
    pop ebx
    pop edx
    pop ecx
    pop eax

    add esp, 8
    iret

.section .note.GNU-stack,"",@progbits
